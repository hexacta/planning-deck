<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="../bower_components/polymer/lib/mixins/gesture-event-listeners.html">
<link rel="import" href="hx-card.html">

<dom-module id="hx-deck">
  <template>
    <style include="shared-styles">
       :host {
        display: block;
        padding: 10px;
      }
      
      .deck {
        height: 350px;
        width: 250px;
        border: solid 2px red;
      }
      
      hx-card {
        position: absolute;
        /*transition: transform 0.1s ease-in-out;*/
      }
      
      hx-card:nth-child(2n) {
        /*transform: translateX(50%) rotate(20deg);*/
        transform-origin: bottom left;
      }
      
      hx-card:nth-child(3n) {
        transform: translateX(50%) rotate(25deg);
        transform-origin: bottom left;
      }
    </style>

    <div class="deck" on-track="handleTrack">
      <hx-card></hx-card>
      <hx-card id="current"></hx-card>
      <hx-card></hx-card>
    </div>
  </template>

  <script>
    class HxDeck extends Polymer.GestureEventListeners(Polymer.Element) {
      static get is() { return 'hx-deck'; }

      handleTrack(e) {
        switch (e.detail.state) {
          case 'start':
            this.$.current.style.transition = '';
            break;
          case 'track':
            this.move(e.detail.dx);
            break;
          case 'end':
            this.$.current.style.transition = 'transform 0.5s ease-in-out';
            this.$.current.style.transform = 'translateX(0px)';
            break;
        }
        e.preventDefault();
        e.stopPropagation();
      }

      move(dx) {
        this.$.current.style.transform = `translateX(${dx}px)`;
      }


    }

    window.requestAnimationFramePromise = _ => new Promise(requestAnimationFrame);
    window.customElements.define(HxDeck.is, HxDeck);
  </script>
</dom-module>